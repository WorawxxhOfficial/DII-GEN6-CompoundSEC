package keycards;

import java.time.LocalTime;
import java.util.Random;

/**
 * CardGenerator: р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕кр╕гр╣Йр╕▓р╕Зр╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Ър╕▒р╕Хр╕г (Card ID) р╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕б
 *
 * ЁЯЯв User Story р╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З:
 * - "р╣Гр╕Щр╕Рр╕▓р╕Щр╕░р╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕ер╕гр╕░р╕Ър╕Ъ р╕Йр╕▒р╕Щр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╕гр╕░р╕Ър╕Ър╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕гр╣Йр╕▓р╕Зр╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Ър╕▒р╕Хр╕гр╣Др╕Фр╣Йр╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕бр╣Бр╕ер╕░р╣Др╕бр╣Ир╕Лр╣Йр╕│р╕Бр╕▒р╕Щ"
 * - "р╣Гр╕Щр╕Рр╕▓р╕Щр╕░р╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕ер╕гр╕░р╕Ър╕Ъ р╕Йр╕▒р╕Щр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Гр╕лр╣Йр╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Ър╕▒р╕Хр╕гр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕кр╣Ар╕зр╕ер╕▓ р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕░р╕Ър╕╕р╕Кр╣Ир╕зр╕Зр╣Ар╕зр╕ер╕▓р╕Чр╕╡р╣Ир╕нр╕нр╕Бр╕Ър╕▒р╕Хр╕гр╣Др╕Фр╣Й"
 *
 * ЁЯЯв Features:
 * - р╕кр╕гр╣Йр╕▓р╕Зр╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Ър╕▒р╕Хр╕гр╣Бр╕Ър╕Ър╕кр╕╕р╣Ир╕бр╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Лр╣Йр╕│р╕Бр╕▒р╕Щ
 * - р╣Гр╕Кр╣Й **Time-Based Encryption** р╣Вр╕Фр╕вр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕зр╕ер╕▓р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щр╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╣Гр╕Щр╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Ър╕▒р╕Хр╕г
 */
public class CardGenerator {

    /**
     * р╕кр╕гр╣Йр╕▓р╕Зр╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Ър╕▒р╕Хр╕г (Card ID) р╣Вр╕Фр╕вр╕гр╕зр╕бр╣Ар╕ер╕Вр╕кр╕╕р╣Ир╕б 7 р╕лр╕ер╕▒р╕Бр╕Бр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕зр╕ер╕▓р╣Бр╕Ър╕Ъ Time-Based Encryption
     * @return р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Ър╕▒р╕Хр╕гр╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ "XXXXXXXTTTT" (р╣Ар╕ер╕Вр╕кр╕╕р╣Ир╕б 7 р╕лр╕ер╕▒р╕Б + р╣Ар╕зр╕ер╕▓р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ 4 р╕лр╕ер╕▒р╕Б)
     */
    public static String generateCardID() {
        Random rand = new Random();

        // р╕кр╕╕р╣Ир╕бр╣Ар╕ер╕В 7 р╕лр╕ер╕▒р╕Б (р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Б 1000000 р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕бр╕╡ 7 р╕лр╕ер╕▒р╕Бр╣Ар╕кр╕бр╕н)
        int cardNumber = 1000000 + rand.nextInt(9000000);

        // р╕Фр╕╢р╕Зр╣Ар╕зр╕ер╕▓р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ (р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕Зр╣Бр╕ер╕░р╕Щр╕▓р╕Чр╕╡) р╣Бр╕ер╕░р╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щр╕кр╕Хр╕гр╕┤р╕З р╣Ар╕Кр╣Ир╕Щ "1045" р╕лр╕бр╕▓р╕вр╕Цр╕╢р╕З 10:45 AM
        String timeSuffix = LocalTime.now().toString().replace(":", "").substring(0, 4);

        // р╕гр╕зр╕бр╣Ар╕ер╕Вр╕кр╕╕р╣Ир╕бр╣Бр╕ер╕░р╣Ар╕зр╕ер╕▓р╣Ар╕Вр╣Йр╕▓р╕Фр╣Йр╕зр╕вр╕Бр╕▒р╕Щ
        return cardNumber + timeSuffix;
    }
}
